# AI-ENABLED-HEALTHCARE-CHATBOT
# AI-ENABLED-HEALTHCARE-CHATBOT
## AIM:
To create a AI ENABLED HEALTHCARE CHATBOT using python.
## ABSTRACT:
Machines are becoming capable of performing tasks like humans in this age of Artificial Intelligence. The most vital aspect of living a healthy life is health care, and the most difficult aspect is finding a doctor's consultant. Everyone cannot afford to visit a doctor for every health issue. The objective of the proposed research work is to design or build a Healthcare chat bot in AI to assist in determining the patient's health and providing basic information before contacting a doctor, but only for minor issues. Using a medical chat bot will save healthcare costs while also increasing medical knowledge. 


Our python-based system connects patients with the chatbot that will help them give the correct answers and precautions to their questions. It is developed with the aim to provide helpful information instantly, especially in times when every second is important. The system will also help the users find doctors, clinics, and hospitals nearby their location in emergencies. Healthcare chatbots are AI-powered virtual assistants that provide personalized support to patients and healthcare providers. They are designed to simulate human-like conversation, enabling patients to interact with them as they would with a real person. Chatbots can be used in various healthcare settings, such as hospitals, clinics, and pharmacies, to provide medical information, schedule appointments.The objective of the proposed research work is to design or build a Healthcare chat bot in AI to assist in determining the patient's health and providing basic information before contacting a doctor, but only for minor issues. Using a medical chat bot will save healthcare costs while also increasing medical knowledge.
## INTRODUCTION:
Artificial Intelligence (AI) and automation have rapidly become popular in many industries, including healthcare. One of the most fascinating applications of AI and automation in healthcare is using chatbots. Chatbots in healthcare are computer programs designed to simulate conversation with human users, providing personalized assistance and support. Healthcare chatbots are AI-powered virtual assistants that provide personalized support to patients and healthcare providers. 

They are designed to simulate human-like conversation, enabling patients to interact with them as they would with a real person. These chatbots are trained on healthcare-related data and can respond to many patient inquiries, including appointment scheduling, prescription refills, and symptom checking.
 
AI chatbots are used in healthcare to provide patients with a more personalized experience while reducing the workload of healthcare professionals. The objective of the proposed research work is to design or build a Healthcare chat bot in AI to assist in determining the patient's health and providing basic information before contacting a doctor, but only for minor issues. Using a medical chat bot will save healthcare costs while also increasing medical knowledge. It is developed with the aim to provide helpful information instantly, especially in times when every second is important. 
## PROBLEM DEFINITION:
Today in the present era, the major challenges that India as a country is facing are to cater good quality and affordable healthcare services to its growing population and at the same time, they are not cost-efficient. This inaccessibility of healthcare facilities especially in rural areas and the difficulty in accessing means of transport causes patients to postpone their treatment, or option for medical facilities which is closer but at the same time are not cost-efficient and well-matched to their medical needs.

To tackle the above-mentioned problem, we have introduced an AI Healthcare Bot system. Our python-based system connects patients with the chatbot that will help them give the correct answers and precautions to their questions. It is developed with the aim to provide helpful information instantly, especially in times when every second is important. The system will also help the users find doctors, clinics, and hospitals nearby their location in emergencies. 

The main intention behind developing the application is to provide healthcare services in dispersed areas of  India and  identify the  gaps  emerging  in  implementing  cloud computing in the healthcare industry. The main problem in  rural areas is  limited  internet connectivity  and slow internet  services.  People  in  rural  areas  don’t  have sufficient knowledge about using a healthcare application on their smartphone.
## BENIFITS OF AI ENABLED HEALTHCARE CHATBOT:
In today’s technology-driven world, every industry is leveraging the power of AI, and the medical industry is no different. Chatbots for healthcare can automate repetitive and mundane tasks, so healthcare experts can focus on complex ones. Below we cover a few common benefits of chatbots for healthcare. 
•	Chatbots help patients get immediate responses, improving patient engagement, providing better care, and reducing wait time. 
•	AI-enabled healthcare chatbot understands patient behavior to deliver personalized recommendations in real-time. 
•	Delegating repetitive tasks to medical chatbots can help organizations reduce the need for human resources. 
•	Patients with minor medical issues can chat with the bot to get simpler medical advice based on their medical history. 

![image](https://github.com/user-attachments/assets/a9e7107d-1ef9-4368-a4c3-0bd758245ae6)


## SCOPE OF THE PROJECT:

![image](https://github.com/user-attachments/assets/39035563-6a62-4911-b9dc-33bcd3cb2f25)



AI chatbots (aka conversational AI chatbots) are similar to chatbots, but only a more advanced version powered by artificial intelligence. Most AI chatbots today come with Natural Language Processing support which helps them understand the context, solve queries better and learn while doing all this.

You should already have an understanding by now! But here’s a more clear explanation. Consider user, a user visiting a website looking for some information. The AI chatbot pops up on the right side corner of the screen and welcomes.

Now, user types his query on the space provided. The AI chatbot on receiving the query starts analysing what it is. Based on the previous set of data and questions it has already received, the AI chatbot makes a call on what to respond to user’s query. The answer is usually what the AI chatbot thinks is right based on its previous learning. With the combination of natural language processing & artificial intelligence, AI chatbots can seamlessly answer customer queries over a period of time.

Like we said earlier, AI chatbots learn continuously to get better at what they do! So, that’s how AI chatbots work!

Chatbots can provide personalized health information to patients, helping them understand their conditions, medications, and treatment plans. They can offer ongoing support, reminders for medication, and lifestyle recommendations to encourage healthy habits. Chatbots can help users assess their symptoms and provide initial guidance on whether they should seek medical attention, self-manage at home, or consult with a healthcare professional. 

AI chatbots can assist in monitoring patients with chronic conditions by collecting and analyzing relevant health data, providing insights to both patients and healthcare providers. In emergency situations, AI chatbots can assist in providing immediate first aid guidance, helping users take appropriate actions while waiting for professional medical assistance. The successful implementation of AI-enabled healthcare chatbots requires collaboration between technology developers, healthcare professionals, and regulatory bodies to ensure ethical and secure use of these tools in the healthcare ecosystem.

## METHODOLOGY:
![image](https://github.com/user-attachments/assets/174d43d6-913c-4401-b667-6d2bb550b5b9)

## SYSTEM ARCHITECTURE:
![image](https://github.com/user-attachments/assets/85523f64-5886-4695-b3b1-4b41d91a9b0d)

## FLOW CHART:
![image](https://github.com/user-attachments/assets/3cd2dab9-8ec2-40f3-ad55-cd8bd018ca89)



## IMPLEMENTATION:
This Flask web application predicts diseases based on user-provided symptoms.

1.	The steps include importing libraries, configuring a SQLite database, and setting a secret key for sessions. A user model is defined with a token-generating function. 
2.	Routes are created for different pages, and templates are rendered using Jinja2. 
3.	User authentication involves generating a session token. 
4.	Symptom and disease prediction functions use machine learning models. 
5.	The /ask route collects user information through a chat-like interaction.
6.	 External info is retrieved using the DuckDuckGo API. 
7.	To run, install dependencies, set up a virtual environment, and provide the required machine learning model and dataset. Finally, run the Flask app on port 3000.
## OUTPUT AND DISCUSSION
![image](https://github.com/user-attachments/assets/b39e831b-22be-47f0-ab8b-c141edb7e81c)

 
#### Figure 05 Web page

    The web page will be opened after implementation of code
    
![image](https://github.com/user-attachments/assets/62bdf975-ac0e-4079-8ab2-007872e4b70f)

#### Figure 06 Login page
User have to login to the web application/Register(If account not created)
![image](https://github.com/user-attachments/assets/87229b3a-a864-4843-adb3-e48e3b215ba0)

#### Figure 07 Chat page
After login to the web application ,The chat option will be enabled .The user can interact with the web chatbot and ask the questions. Like shown below it ask’s for 

1.Predict symptoms (enter the disease name)

2.Check the Disease symptoms (User must choose the option)

![image](https://github.com/user-attachments/assets/ca780597-d56a-4e20-9575-71e61c4e6445)

#### Figure 08 Symptoms List
This is the symptoms box which User have to choose

![image](https://github.com/user-attachments/assets/2f8de843-53cb-4342-bd66-43bc9a72fd41)

#### Figure 09 AI predicted the disease suggesting  the  nearby hospital
In this image the AI predicted the disease which the user is suffering for and suggesting the nearby hospital


![image](https://github.com/user-attachments/assets/2ce9adda-d4ef-49a6-93a9-61b636687660)


#### figure 10 AI Suggesting the nearby hospital
AI directly opens the browser and searches for the nearby hospital which is realted to users disease




![image](https://github.com/user-attachments/assets/852ca521-eefb-4d5b-b82f-57393ee949ce)

#### Figure 11 BMI checking
In the web application the user can also check for the BMI(Body mass Index) to check the users physical codition



## VALIDATION:
### MEAN CONFUSSION MATRIX:
![image](https://github.com/user-attachments/assets/8a20cede-abdf-4b3a-9b63-dfed112160ee)
### AVERAGE CONFUSSION MATRIX:
![image](https://github.com/user-attachments/assets/00aacefd-4b35-4275-9f4c-4080620a7cd3)
### ACCURACY:
![image](https://github.com/user-attachments/assets/83e498c5-e810-42cb-902e-15adec48784d)


## CONCLUSION:
The main aim of the project AI Based Healthcare chatbot system using Natural Language Processing, which is easy to use and more secure than the current system it will cure the diseases and helps to maintain proper health in the current system. This system reduces the possibility of diseases. The information is processed and store in the database, then it is reverted to the user. Also, it provides an accurate information about the heath symptoms and medicines to the patients. The government will also keep the track of the medicines supplied to the medicals and hospitals. By using diagnosis software, the results are generated accurate and fast. For end users it became easy to gain access in healthcare website and explore different types of services. After using such web-based applications, the results of healthcare were affected in different countries and rate of mortality was steadily decreased. With the help of this natural language processing the proposed system can help the government organizations and hospitals also help in the development of the country. Thus, we successfully build up a system for hospitals and medical institute so that user can ask their queries with the medical assistant and book the doctor’s appointment by giving text messages.

## APPENDIX:
```
import random
from flask import jsonify
import secrets
from flask import Flask, render_template, flash, redirect, url_for, session, logging, request, session
from flask_sqlalchemy import SQLAlchemy

ALLOWED_EXTENSIONS = ['png', 'jpg', 'jpeg']
app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///database.db'
db = SQLAlchemy(app)
app.secret_key = "m4xpl0it"


def make_token():
    """
    Creates a cryptographically-secure, URL-safe string
    """
    return secrets.token_urlsafe(16) 
 
class user(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80))
    email = db.Column(db.String(120))
    password = db.Column(db.String(80))


@app.route("/")
def index():
    return render_template("index.html")


userSession = {}

@app.route("/user")
def index_auth():
    my_id = make_token()
    userSession[my_id] = -1
    return render_template("index_auth.html",sessionId=my_id)


@app.route("/instruct")
def instruct():
    return render_template("instructions.html")

@app.route("/upload")
def bmi():
    return render_template("bmi.html")

@app.route("/diseases")
def diseases():
    return render_template("diseases.html")


@app.route('/pred_page')
def pred_page():
    pred = session.get('pred_label', None)
    f_name = session.get('filename', None)
    return render_template('pred.html', pred=pred, f_name=f_name)



@app.route("/login", methods=["GET", "POST"])
def login():
    if request.method == "POST":
        uname = request.form["uname"]
        passw = request.form["passw"]

        login = user.query.filter_by(username=uname, password=passw).first()
        if login is not None:
            return redirect(url_for("index_auth"))
    return render_template("login.html")


@app.route("/register", methods=["GET", "POST"])
def register():
    if request.method == "POST":
        uname = request.form['uname']
        mail = request.form['mail']
        passw = request.form['passw']

        register = user(username=uname, email=mail, password=passw)
        db.session.add(register)
        db.session.commit()

        return redirect(url_for("login"))
    return render_template("register.html")


import msgConstant as msgCons
import re

all_result = {
    'name':'',
    'age':0,
    'gender':'',
    'symptoms':[]
}


import pandas as pd
import numpy as np
from joblib import load
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity

def predict_symptom(user_input, symptom_list):

user_input_tokens = user_input.lower().replace("_"," ").split()

    similarity_scores = []
    for symptom in symptom_list:

        symptom_tokens = symptom.lower().replace("_"," ").split()

        count_vector = np.zeros((2, len(set(user_input_tokens + symptom_tokens))))
        for i, token in enumerate(set(user_input_tokens + symptom_tokens)):
            count_vector[0][i] = user_input_tokens.count(token)
            count_vector[1][i] = symptom_tokens.count(token)

        # Calculate cosine similarity between count vectors
        similarity = cosine_similarity(count_vector)[0][1]
        similarity_scores.append(similarity)

    # Return symptom with highest similarity score
    max_score_index = np.argmax(similarity_scores)
    return symptom_list[max_score_index]




import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.metrics.pairwise import cosine_similarity

# Load the dataset into a pandas dataframe
df = pd.read_excel('dataset.xlsx')

# Get all unique symptoms
symptoms = set()
for s in df['Symptoms']:
    for symptom in s.split(','):
        symptoms.add(symptom.strip())



def predict_disease_from_symptom(symptom_list):


    user_symptoms = symptom_list
    # Vectorize symptoms using CountVectorizer
    vectorizer = CountVectorizer()
    X = vectorizer.fit_transform(df['Symptoms'])
    user_X = vectorizer.transform([', '.join(user_symptoms)])

    # Compute cosine similarity between user symptoms and dataset symptoms
    similarity_scores = cosine_similarity(X, user_X)

    # Find the most similar disease(s)
    max_score = similarity_scores.max()
    max_indices = similarity_scores.argmax(axis=0)
    diseases = set()
    for i in max_indices:
        if similarity_scores[i] == max_score:
            diseases.add(df.iloc[i]['Disease'])

    # Output results
    if len(diseases) == 0:
        return "<b>No matching diseases found</b>",""
    elif len(diseases) == 1:
        print("The most likely disease is:", list(diseases)[0])
        disease_details = getDiseaseInfo(list(diseases)[0])
        return f"<b>{list(diseases)[0]}</b><br>{disease_details}",list(diseases)[0]
    else:
        return "The most likely diseases are<br><b>"+ ', '.join(list(diseases))+"</b>",""

        

    symptoms = {'itching': 0, 'skin_rash': 0, 'nodal_skin_eruptions': 0, 'continuous_sneezing': 0,
                'shivering': 0, 'chills': 0, 'joint_pain': 0, 'stomach_pain': 0, 'acidity': 0, 'ulcers_on_tongue': 0,
                'muscle_wasting': 0, 'vomiting': 0, 'burning_micturition': 0, 'spotting_ urination': 0, 'fatigue': 0,
                'weight_gain': 0, 'anxiety': 0, 'cold_hands_and_feets': 0, 'mood_swings': 0, 'weight_loss': 0,
                'restlessness': 0, 'lethargy': 0, 'patches_in_throat': 0, 'irregular_sugar_level': 0, 'cough': 0,
                'high_fever': 0, 'sunken_eyes': 0, 'breathlessness': 0, 'sweating': 0, 'dehydration': 0,
                'indigestion': 0, 'headache': 0, 'yellowish_skin': 0, 'dark_urine': 0, 'nausea': 0, 'loss_of_appetite': 0,
                'pain_behind_the_eyes': 0, 'back_pain': 0, 'constipation': 0, 'abdominal_pain': 0, 'diarrhoea': 0, 'mild_fever': 0,
                'yellow_urine': 0, 'yellowing_of_eyes': 0, 'acute_liver_failure': 0, 'fluid_overload': 0, 'swelling_of_stomach': 0,
                'swelled_lymph_nodes': 0, 'malaise': 0, 'blurred_and_distorted_vision': 0, 'phlegm': 0, 'throat_irritation': 0,
                'redness_of_eyes': 0, 'sinus_pressure': 0, 'runny_nose': 0, 'congestion': 0, 'chest_pain': 0, 'weakness_in_limbs': 0,
                'fast_heart_rate': 0, 'pain_during_bowel_movements': 0, 'pain_in_anal_region': 0, 'bloody_stool': 0,
                'irritation_in_anus': 0, 'neck_pain': 0, 'dizziness': 0, 'cramps': 0, 'bruising': 0, 'obesity': 0, 'swollen_legs': 0,
                'swollen_blood_vessels': 0, 'puffy_face_and_eyes': 0, 'enlarged_thyroid': 0, 'brittle_nails': 0, 'swollen_extremeties': 0,
                'excessive_hunger': 0, 'extra_marital_contacts': 0, 'drying_and_tingling_lips': 0, 'slurred_speech': 0,
                'knee_pain': 0, 'hip_joint_pain': 0, 'muscle_weakness': 0, 'stiff_neck': 0, 'swelling_joints': 0, 'movement_stiffness': 0,
                'spinning_movements': 0, 'loss_of_balance': 0, 'unsteadiness': 0, 'weakness_of_one_body_side': 0, 'loss_of_smell': 0,
                'bladder_discomfort': 0, 'foul_smell_of urine': 0, 'continuous_feel_of_urine': 0, 'passage_of_gases': 0, 'internal_itching': 0,
                'toxic_look_(typhos)': 0, 'depression': 0, 'irritability': 0, 'muscle_pain': 0, 'altered_sensorium': 0,
                'red_spots_over_body': 0, 'belly_pain': 0, 'abnormal_menstruation': 0, 'dischromic _patches': 0, 'watering_from_eyes': 0,
                'increased_appetite': 0, 'polyuria': 0, 'family_history': 0, 'mucoid_sputum': 0, 'rusty_sputum': 0, 'lack_of_concentration': 0,
                'visual_disturbances': 0, 'receiving_blood_transfusion': 0, 'receiving_unsterile_injections': 0, 'coma': 0,
                'stomach_bleeding': 0, 'distention_of_abdomen': 0, 'history_of_alcohol_consumption': 0, 'fluid_overload.1': 0,
                'blood_in_sputum': 0, 'prominent_veins_on_calf': 0, 'palpitations': 0, 'painful_walking': 0, 'pus_filled_pimples': 0,
                'blackheads': 0, 'scurring': 0, 'skin_peeling': 0, 'silver_like_dusting': 0, 'small_dents_in_nails': 0, 'inflammatory_nails': 0,
                'blister': 0, 'red_sore_around_nose': 0, 'yellow_crust_ooze': 0}
    
    # Set value to 1 for corresponding symptoms
    
    for s in symptom_list:
        index = predict_symptom(s, list(symptoms.keys()))
        print('User Input: ',s," Index: ",index)
        symptoms[index] = 1
    
    # Put all data in a test dataset
    df_test = pd.DataFrame(columns=list(symptoms.keys()))
    df_test.loc[0] = np.array(list(symptoms.values()))
    print(df_test.head()) 
    # Load pre-trained model
    clf = load(str("model/random_forest.joblib"))
    result = clf.predict(df_test)

    disease_details = getDiseaseInfo(result[0])
    
    # Cleanup
    del df_test
    
    return f"<b>{result[0]}</b><br>{disease_details}",result[0]



import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.metrics.pairwise import cosine_similarity


# Get all unique diseases
diseases = set(df['Disease'])

def get_symtoms(user_disease):
    # Vectorize diseases using CountVectorizer
    vectorizer = CountVectorizer()
    X = vectorizer.fit_transform(df['Disease'])
    user_X = vectorizer.transform([user_disease])

    # Compute cosine similarity between user disease and dataset diseases
    similarity_scores = cosine_similarity(X, user_X)

    # Find the most similar disease(s)
    max_score = similarity_scores.max()
    print(max_score)
    if max_score < 0.7:
        print("No matching diseases found")
        return False,"No matching diseases found"
    else:
        max_indices = similarity_scores.argmax(axis=0)
        symptoms = set()
        for i in max_indices:
            if similarity_scores[i] == max_score:
                symptoms.update(set(df.iloc[i]['Symptoms'].split(',')))
        # Output results

        print("The symptoms of", user_disease, "are:")
        for sym in symptoms:
            print(str(sym).capitalize())

        return True,symptoms


from duckduckgo_search import ddg

def getDiseaseInfo(keywords):
    results = ddg(keywords, region='wt-wt', safesearch='Off', time='y')
    return results[0]['body']


@app.route('/ask',methods=['GET','POST'])
def chat_msg():

    user_message = request.args["message"].lower()
    sessionId = request.args["sessionId"]

    rand_num = random.randint(0,4)
    response = []
    if request.args["message"]=="undefined":

        response.append(msgCons.WELCOME_GREET[rand_num])
        response.append("What is your good name?")
        return jsonify({'status': 'OK', 'answer': response})
    else:


        currentState = userSession.get(sessionId)

        if currentState ==-1:
            response.append("Hi "+user_message+", To predict your disease based on symptopms, we need some information about you. Please provide accordingly.")
            userSession[sessionId] = userSession.get(sessionId) +1
            all_result['name'] = user_message            

        if currentState==0:
            username = all_result['name']
            response.append(username+", what is you age?")
            userSession[sessionId] = userSession.get(sessionId) +1

        if currentState==1:
            pattern = r'\d+'
            result = re.findall(pattern, user_message)
            if len(result)==0:
                response.append("Invalid input please provide valid age.")
            else:                
                if float(result[0])<=0 or float(result[0])>=130:
                    response.append("Invalid input please provide valid age.")
                else:
                    all_result['age'] = float(result[0])
                    username = all_result['name']
                    response.append(username+", Choose Option ?")            
                    response.append("1. Predict Disease")
                    response.append("2. Check Disease Symtoms")
                    userSession[sessionId] = userSession.get(sessionId) +1

        if currentState==2:

            if '2' in user_message.lower() or 'check' in user_message.lower():
                username = all_result['name']
                response.append(username+", What's Disease Name?")
                userSession[sessionId] = 20
            else:

                username = all_result['name']
                response.append(username+", What symptoms are you experiencing?")         
                response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
                userSession[sessionId] = userSession.get(sessionId) +1

        if currentState==3:

            
            all_result['symptoms'].extend(user_message.split(","))
            username = all_result['name']
            response.append(username+", What kind of symptoms are you currently experiencing?")            
            response.append("1. Check Disease")   
            response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
            userSession[sessionId] = userSession.get(sessionId) +1


        if currentState==4:

            if '1' in user_message or 'disease' in user_message:
                disease,type = predict_disease_from_symptom(all_result['symptoms'])  
                response.append("<b>The following disease may be causing your discomfort</b>")
                response.append(disease)
                response.append(f'<a href="https://www.google.com/search?q={type} disease hospital near me" target="_blank">Search Near By Hospitals</a>')   
                userSession[sessionId] = 10

            else:

                all_result['symptoms'].extend(user_message.split(","))
                username = all_result['name']
                response.append(username+", Could you describe the symptoms you're suffering from?")            
                response.append("1. Check Disease")   
                response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
                userSession[sessionId] = userSession.get(sessionId) +1

    
        if currentState==5:
            if '1' in user_message or 'disease' in user_message:
                disease,type = predict_disease_from_symptom(all_result['symptoms'])  
                response.append("<b>The following disease may be causing your discomfort</b>")
                response.append(disease)
                response.append(f'<a href="https://www.google.com/search?q={type} disease hospital near me" target="_blank">Search Near By Hospitals</a>')   

                userSession[sessionId] = 10

            else:

                all_result['symptoms'].extend(user_message.split(","))
                username = all_result['name']
                response.append(username+", What are the symptoms that you're currently dealing with?")            
                response.append("1. Check Disease")   
                response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
                userSession[sessionId] = userSession.get(sessionId) +1

        if currentState==6:    

            if '1' in user_message or 'disease' in user_message:
                disease,type = predict_disease_from_symptom(all_result['symptoms'])  
                response.append("The following disease may be causing your discomfort")
                response.append(disease)
                response.append(f'<a href="https://www.google.com/search?q={type} disease hospital near me" target="_blank">Search Near By Hospitals</a>')   
                userSession[sessionId] = 10
            else:
                all_result['symptoms'].extend(user_message.split(","))
                username = all_result['name']
                response.append(username+", What symptoms have you been experiencing lately?")            
                response.append("1. Check Disease")   
                response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
                userSession[sessionId] = userSession.get(sessionId) +1

        if currentState==7:
            if '1' in user_message or 'disease' in user_message:
                disease,type = predict_disease_from_symptom(all_result['symptoms'])  
                response.append("<b>The following disease may be causing your discomfort</b>")
                response.append(disease)
                response.append(f'<a href="https://www.google.com/search?q={type} disease hospital near me" target="_blank">Search Near By Hospitals</a>')   
                userSession[sessionId] = 10
            else:
                all_result['symptoms'].extend(user_message.split(","))
                username = all_result['name']
                response.append(username+", What are the symptoms that you're currently dealing with?")            
                response.append("1. Check Disease")   
                response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
                userSession[sessionId] = userSession.get(sessionId) +1


        if currentState==8:    

            if '1' in user_message or 'disease' in user_message:
                disease,type = predict_disease_from_symptom(all_result['symptoms'])  
                response.append("The following disease may be causing your discomfort")
                response.append(disease)
                response.append(f'<a href="https://www.google.com/search?q={type} disease hospital near me" target="_blank">Search Near By Hospitals</a>')   
                userSession[sessionId] = 10
            else:
                all_result['symptoms'].extend(user_message.split(","))
                username = all_result['name']
                response.append(username+", What symptoms have you been experiencing lately?")            
                response.append("1. Check Disease")   
                response.append('<a href="/diseases" target="_blank">Symptoms List</a>')   
                userSession[sessionId] = userSession.get(sessionId) +1

        if currentState==10:
            response.append('<a href="/user" target="_blank">Predict Again</a>')   

        
        if currentState==20:

            result,data = get_symtoms(user_message)
            if result:
                response.append(f"The symptoms of {user_message} are")
                for sym in data:
                    response.append(sym.capitalize())

            else:response.append(data)

            userSession[sessionId] = 2
            response.append("")
            response.append("Choose Option ?")            
            response.append("1. Predict Disease")
            response.append("2. Check Disease Symtoms")




                

        return jsonify({'status': 'OK', 'answer': response})




if __name__ == "__main__":

    db.create_all()
    app.run(debug=False, port=3000)
```



















